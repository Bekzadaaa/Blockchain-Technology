<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>On-Chain Message Board</title>
</head>
<body>

<h2>On-Chain Message Board</h2>

<button onclick="connectWallet()">Connect MetaMask</button>

<p><b>Current message:</b></p>
<p id="message">Loading...</p>

<input id="newMessage" placeholder="Enter new message">
<button onclick="updateMessage()">Update Message</button>

<script src="https://cdn.jsdelivr.net/npm/ethers@6.6.2/dist/ethers.umd.min.js"></script>
<script>
  let provider;
  let signer;
  let contract;

  const contractAddress = "0xd17a342240717Cea35d70e41183F7540486FcABc";;

  const abi = [
    "function message() view returns (string)",
    "function updateMessage(string _newMessage)"
  ];

  async function connectWallet() {
    await window.ethereum.request({ method: "eth_requestAccounts" });

    provider = new ethers.BrowserProvider(window.ethereum);
    signer = await provider.getSigner();
    contract = new ethers.Contract(contractAddress, abi, signer);

    loadMessage();
  }

  async function loadMessage() {
    const msg = await contract.message();
    document.getElementById("message").innerText = msg;
  }

  async function updateMessage() {
    const newMsg = document.getElementById("newMessage").value;
    const tx = await contract.updateMessage(newMsg);
    await tx.wait();
    loadMessage();
  }
</script>

</body>
</html>